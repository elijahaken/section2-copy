<!-- Section 2 Group 14 -->
<!--
Group Members
Elijah Aken
Lily Tait
Wing Yu Chu
Caitlyn Stokes --> 
<!-- Employee/admin login or signup page -->
<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Notusingthis.com</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />

    <style>
        body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
        
        background-size: cover;
        background-attachment: fixed;
        }
        video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
        }
        video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: -1;
}

.overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* Adjust the alpha (last value) for transparency */
    z-index: -1;
}

        h1 {
        text-align: center;
        color: #333;
        }

        .ACC {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        margin-top: 20px;
        }

        fieldset {
        border: 2px solid #ccc;
        border-radius: 8px;
        margin: 10px;
        padding: 10px;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        width: 260px; /* Slightly reduced width */
        max-width: calc(100% - 20px); /* Adjusted maximum width */
        overflow: hidden; /* Hides any content that overflows */
        }

        fieldset img {
        opacity: 0.5; /* You can adjust the opacity value (0 being fully transparent, 1 being fully visible) */
        }

        legend {
        font-weight: bold;
        font-size: 1.2em;
        color: #333;
        }

        label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        }


        input {
        width: calc(100% - 16px); 
        padding: 5px;
        margin-bottom: 10px;
        box-sizing: border-box;
        font-size: 14px;
        border-radius:10px;
        background-color: #fafafa;
        border:0;
        box-shadow:0 0 4px rgba(0,0,0,0.3);
        transition: .3s box-shadow;
        }

        .input:hover {
        box-shadow:0 0 4px rgba(57, 56, 56, 0.5);
        }
        

        #outputMessage {
        text-align: center;
        margin-top: 20px;
        color: orange;
        font-size: 18px; 
        }

        .form-container {
            margin-top: 100px; /* Adjust this value to leave space for the navbar */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        /* Adjust the width and margin as needed for the fieldsets */
        .form-container fieldset {
            /* ... Your existing fieldset styles ... */
            width: 300px;
            margin: 10px;
        }

        .password-container {
    position: relative;
    width: 80%;
    margin-bottom: 10px; 
    }

    .password-container input[type="password"] {
    width: 100%;
    padding-right: 30px;
    font-size: 14px;
    }

    .password-icon {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    right: 5px;
    cursor: pointer;
    width: 20px; /* Adjust this as per the image size */
        }   



/* CSS */
.form-container fieldset form button {
  display: inline-block;
  margin: 0 5px; /* Adjust the margin for desired spacing */
}

.button-75 {
  align-items: center;
  background-image: linear-gradient(135deg, #817579 40%, #c4bdb9);
  border: 0;
  border-radius: 8px;
  box-sizing: border-box;
  color: #fff;
  cursor: pointer;
  display: flex;
  justify-content: center;
  font-family: "Codec cold",sans-serif;
  font-size: 12px;
  font-weight: 700;
  height: 54px;
  max-width: 100%;
  text-decoration: none;
  text-transform: uppercase;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  padding: 18px;
}

.button-75:active {
  outline: 0;
}

.button-75:hover {
  outline: 0;
  background-image: linear-gradient(135deg, #b85979 40%, #c4bdb9);
}

.button-75 span {
  transition: all 200ms;
}

.button-75:hover span {
  transform: scale(.9);
  opacity: .75;
}

@media screen and (max-width: 991px) {
  .button-75 {
    font-size: 15px;
    height: 50px;
  }

  .button-75 span {
    line-height: 50px;
  }
}
    </style>

</head>

<body id="page-top">
    <video width="100%" height="auto" autoplay loop muted>
        <source src="/Provo_Aerial.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <div class="overlay"></div>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom fixed-top">
        <div class="container px-5">
            <a class="navbar-brand" href="/">
                <img class="navbar-brand-img" src="/Untitled design.png" alt="Logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span
                    class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/login">Log In/Sign Up</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <br><br><br><br><br>

    <div class="form-container">
        <!-- Sign Up Section -->
        <fieldset style="width: 300px;">
            <legend>Sign Up</legend>
            <form id="signupForm" method="post" action="/signup" onsubmit="return validateAndCreateAccount();">
                <label for="txtNewUserName">Username:</label>
                <input type="text" id="txtNewUserName" name="username" required><br>

                <label for="txtNewPassword">Password:</label>
                <input type="password" id="txtNewPassword" name="password" required><br>

                <label for="txtEmail">Email:</label>
                <input type="email" id="txtEmail" name="email" required><br>

                <label for="txtPhone">Phone:</label>
                <input type="text" id="txtPhone" name="phone" required><br>

                <label for="txtAccessKey">Access Key:</label>
                <input type="password" id="txtAccessKey" name="Access_key" required><br>

                <button type="submit">Sign Up</button>
            </form>
        </fieldset>

        <br><br>

        <fieldset style="width: 300px;">
            <legend>Login</legend>
            <form id="loginForm" action="/login" method="post" onsubmit="return validateLogin();">
                <input type="text" placeholder="Username" name="username" style="width: 80%;" required><br>
                <div class="password-container">
                    <input type="password" placeholder="Password" name="password" class="password-input"
                        style="width: 100%; padding-right: 30px;" required>
                    <img src="assets/img/eye-close.png" class="password-icon" id="btnShowLogin"
                        onclick="toggleLoginPassword();">
                </div>
        
                <button class="button-75" role="button" type="submit"><span class="text">Login</span></button>
                <button class="button-75" role="button" onclick="resetLoginForm();"><span class="text">Reset</span></button>
            </form>
        
            <% if (typeof error !== 'undefined') { %>
                <div class="error-message">
                    <%= error %>
                </div>
            <% } %>
        </fieldset>



    <script>
        function toggleLoginPassword() {
            // Your existing function
        }

        function resetLoginForm() {
            // Your existing function
        }

        let bShowNew = false;
        let bShowLogin = false;

        var userData = [];

        function toggleNewPassword() {
            // Your existing function
        }

        function toggleLoginPassword() {
            // Your existing function
        }

        function validateAndCreateAccount() {
            let newUserName = document.getElementById("txtNewUserName").value;
            let email = document.getElementById("txtEmail").value;
            let phone = document.getElementById("txtPhone").value;
            let newAccessKey = document.getElementById("txtAccessKey").value;

            // Validate email format
            if (!email.includes('@') || !email.includes('.')) {
                showAlert("Invalid email format");
                return false;
            }

            // Validate Access Key
            if (newAccessKey !== 'ProvoCity') {
                showAlert("Invalid Access Key. Access Keys are provided to city and county employees of Provo.");
                return false;
            }

            const lowerCaseUserName = newUserName.toLowerCase();

// Redirect based on username
        if (lowerCaseUserName.includes('admin')) {
            // Redirect to data.ejs
            window.location.href = '/data';
        } else {
            // Redirect to data2.ejs
            window.location.href = '/data2';
        }



            // Check for duplicate username
            if (isDuplicateValue(newUserName, 'username')) {
                showAlert("Invalid username. Username already exists.");
                return false;
            }

            // Check for duplicate email
            if (isDuplicateValue(email, 'email')) {
                showAlert("Invalid email. Email already exists.");
                return false;
            }

            // Check for duplicate phone number
            if (isDuplicateValue(phone, 'phone')) {
                showAlert("Invalid phone number. Phone number already exists.");
                return false;
            }

            // Reset the sign-up form
            resetSignUpForm();

            // Hide the signup form after showing the message
            document.getElementById("signupForm").style.display = "none";

            // Display success message or perform other actions
            showAlert("Account created for " + newUserName + ".\nReturn to sign up");

            // Prevent form submission (optional)
            return false;
        }

        function showAlert(message) {
            alert(message);
        }

        function resetSignUpForm() {
            document.getElementById("signupForm").reset();
        }

        function validateLogin() {
            // Your existing login validation logic
        }


    </script>
</body>
</html>